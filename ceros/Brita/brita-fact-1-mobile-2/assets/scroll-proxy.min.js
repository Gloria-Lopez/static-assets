!function(a,b){"use strict";"undefined"!=typeof exports?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a)}(this,function(a){"use strict";var b="CEROS_SCROLL_PROXY_LOADED";if(!window[b]){window[b]=!0;for(var c="ceros-embedded-viewport:",d={PING:"ping",READY:"ready",POSITION:"position",SCROLL_TO:"scroll-to",GOTO_URL:"goto-url",VARIANT_DETECTION:"variant-detection"},e="data-aspectRatio",f=[],g=document.querySelectorAll("iframe.ceros-experience"),h=function(){i(),j()},i=function(){for(var a=0;a<g.length;a++){var b=g[a],c=k(b),d=c.getAttribute(e);if(!d){var f=o(c.style.paddingBottom);c.setAttribute(e,f)}}},j=function(){for(var a=0;a<g.length;a++){var b=g[a],c=k(b);"true"===b.getAttribute("data-ceros-subpixel-oversize")&&(b.setAttribute("data-ceros-subpixel-oversize","false"),b.style.width=b.getAttribute("data-ceros-subpixel-original-width"),b.style.height=b.getAttribute("data-ceros-subpixel-original-height"));var d=b.getBoundingClientRect(),e=Math.ceil(d.width),f=Math.ceil(d.height),h=d.width!==e||d.height!==f;if(h){b.setAttribute("data-ceros-subpixel-oversize","true"),b.setAttribute("data-ceros-subpixel-original-width",b.style.width),b.setAttribute("data-ceros-subpixel-original-height",b.style.height);var i=o(c.style.paddingBottom);c.style.overflow="hidden",b.style.width=e+"px",b.style.height=Math.ceil(e/i)+"px"}}},k=function(a){return a.parentElement},l=function(a,b){var c=k(a),d="desktop"===b?"data-aspectRatio":"data-"+b+"-aspectRatio",f=c.getAttribute(d);return f||(f=c.getAttribute(e)),f?+f:null},m=function(a,b){var c=l(a,b);c&&n(a,c)},n=function(a,b){var c=k(a),d=o(c.style.paddingBottom);d!==b&&(c.style.paddingBottom=p(b),s())},o=function(a){return 100/parseFloat(a)},p=function(a){return(100/a).toFixed(2)+"%"},q=function(a){var b=a.getBoundingClientRect(),c={top:-b.top,bottom:window.innerHeight-b.top,windowWidth:window.innerWidth,windowHeight:window.innerHeight};z(a,d.POSITION,c)},r=function(){for(var a=0;a<f.length;a++)q(f[a])},s=function(){j();for(var a=0;a<f.length;a++)q(f[a])},t=function(a,b){for(var c=null,d=0;d<a.length;d++)if(a[d].contentWindow===b){c=a[d];break}return c},u=function(a){var b=t(document.getElementsByTagName("iframe"),a);b&&(f.push(b),q(b))},v=function(a,b){var c=t(f,a);if(c){var d=Math.max(0,b.scrollPosition-b.pageHeight+b.visibleHeight),e=c.getBoundingClientRect(),g=window.pageYOffset+e.top,h=window.pageYOffset+e.bottom,i=e.bottom-e.top,j=d*i/b.visibleHeight,k=h-window.innerHeight;window.scroll(0,Math.min(j+g,k))}},w=function(a,b){b.urlOpenInNewWindow?window.open(b.url):window.location=b.url},x=function(a,b){var c=t(f,a);c&&m(c,b.variant)},y=function(a){var b,e;try{b=JSON.parse(a.data),e=b&&b.event&&b.event.substr(0,c.length)===c}catch(f){return}if(e)switch(b.event.substr(c.length)){case d.READY:u(a.source);break;case d.SCROLL_TO:v(a.source,b);break;case d.GOTO_URL:w(a.source,b);break;case d.VARIANT_DETECTION:x(a.source,b)}},z=function(a,b,d){var e={event:c+b};if(d)for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);var g=JSON.stringify(e);a.contentWindow.postMessage(g,"*")},A=document.getElementsByTagName("iframe"),B=0;B<A.length;B++)f.indexOf(-1===A[B])&&z(A[B],d.PING);window.sendViewportPositionEvent=q,window.addEventListener("load",h),window.addEventListener("message",y),window.addEventListener("scroll",r),window.addEventListener("resize",s)}});